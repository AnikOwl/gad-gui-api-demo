<!DOCTYPE html>
<html>

<head>
    <title>🦎 GAD</title>
    <link rel="icon" href="/data/icons/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Roboto" rel="stylesheet" />
    <link rel="stylesheet" href="/css/controls.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/infoBoxes.css" />
    <link rel="stylesheet" href="./css/practice-controls.css" />
</head>

<body>
    <header>
        <div style="display: grid; grid-template-columns: 4fr 1fr" class="main-nav-menu">
            <h1 id="menu-practice" class="nav-menu"></h1>
        </div>
    </header>
    <style>
        th,
        td {
            border-bottom: 2px solid #dddddd;
        }

        .overlay.active {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .sidepanel {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 9999;
            top: 0;
            left: 0;
            background-color: #202020;
            overflow-x: hidden;
            padding-top: 60px;
            transition: 0.5s;
            display: flex !important;
            flex-direction: column;
            align-items: center;
        }

        .side-panel-label {
            color: white;
            font-size: 16px;
            padding: 8px 8px 8px 8px;
            text-decoration: none;
            display: block;
        }

        .side-panel-input {
            color: black;
            font-size: 24px;
            padding: 8px 8px 8px 8px;
            text-decoration: none;
            display: block;
            margin: 0 auto;
        }

        .side-panel-button {
            color: white;
            font-size: 12px;
            padding: 8px 8px 8px 8px;
            text-decoration: none;
            display: block;
            margin: 0 auto;
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 10px;
            transition: background-color 0.3s ease;
        }

        .side-panel-button-warn {
            background-color: #8e6e3e;
        }

        .side-panel-button:hover {
            background-color: #347737;
        }

        .side-panel-button:active {
            background-color: #3e8e41;
        }

        .side-panel-button-warn:hover {
            background-color: #634923;
        }

        .sidepanel a {
            padding: 8px 8px 8px 8px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            transition: 0.3s;
            display: flex !important;
            justify-content: center;
            align-items: center;
        }

        .sidepanel a:hover {
            color: #f1f1f1;
        }

        .sidepanel a:hover {
            color: #f1f1f1;
            border: #f1f1f1;
            border-radius: 10px;
        }

        .sidepanel .closebtn {
            font-size: 36px;
            display: block;
        }

        .openbtn {
            height: 100%;
            position: fixed;
            background-color: #202020;
            overflow-x: hidden;
            cursor: pointer;
            border: none;
            color: white;
            z-index: 1;
            top: 60px;
            font-size: 32px;
            width: 60px !important;
        }

        .openbtn:hover {
            background-color: #444;
        }

        .options-side-panel-icons {
            width: 32px;
            font-size: 32px;
            padding-top: 12px;
        }
    </style>

    <br />
    <br />
    <br />
    <div id="side-panel" class="sidepanel"></div>
    <div id="overlay" class="overlay"></div>
    <div align="center">
        <h2>Simple Reservation V3</h2>

        <div style="display: flex; align-content: center; display: flex; align-items: center; justify-content: center">



        </div>
        <td style="text-align: center; padding-right: 0px;"><button class="calculate-button" onclick="calculateOnClick(this)">Calculate</button></td>
    </div>
    <div align="center">
        Results:
        <br />
        <div class="results-container" data-testid="dti-results-container" id="results-container"></div>
    </div>
    <div align="center">
        Results history:
        <br />
        <textarea class="results-history-container" id="results-history-container" readonly> </textarea>
    </div>
    </div>
    <br />
    <br />
    <br />
    <div class="container" style="align-content: center; display: flex; align-items: center; justify-content: center; font-size: 24px">
        <a href="https://jaktestowac.pl" style="color: dimgray">
            <span style="display: flex; align-items: center; justify-self: center; font-size: medium">
                <img src="/data/icons/favicon.png" style="width: 25px !important; height: 25px !important; padding: 0; border: none" alt="" />&nbsp&nbspjaktestowac.pl
            </span>
        </a>
    </div>
</body>

<script type="text/javascript" src="/js/common.js"></script>
<script type="text/javascript" src="/js/header.js"></script>
<script type="text/javascript" src="/version.js"></script>
<script type="text/javascript" src="./js/practice-common.js"></script>

<script>
    const features = [
        { name: 'Food', price: 50, icon: '🥗' },
        { name: 'Pool', price: 40, icon: '🏊‍♂️' },
        { name: 'WiFi', price: 20, icon: '💻' },
        { name: 'Parking', price: 20, icon: '🚗' },
        { name: 'Gym', price: 25, icon: '🏋️‍♂️' },
        { name: 'Spa', price: 44, icon: '🧖‍♂️' },
        { name: 'Pet Friendly', price: 42, icon: '🐾' },
        { name: 'Babysitting', price: 46, icon: '👶' },
        { name: 'Entertainment', price: 50, icon: '🎭' },
        { name: 'Car Rental', price: 120, icon: '🚗' },
        { name: 'VIP Event Access', price: 200, icon: '🚗' },
        { name: 'Premium Golf Package', price: 310, icon: '⛳' }
    ]

    let selectedFeatures = []
    let couponPrice = 0

    // updateDate()
    clearAllCheckboxes()

    function clearAllCheckboxes() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
    }

    function clearAll() {
        clearAllCheckboxes()
        clearButtonBackgroundColor()
        document.getElementById('id-date').value = ''
        document.getElementById('id-range').value = ''
        document.getElementById('lbl-days').innerHTML = '(0)'
        document.getElementById('lbl-date-to').innerHTML = ''
        document.getElementById('price-per-day').innerHTML = 100
        document.querySelector('select').value = 1
        selectedFeatures = []
        couponPrice = 0
        clearCoupon()
    }

    function clearCoupon() {
        document.getElementById('coupon-input').value = ''
        couponPrice = 0
    }

    function checkBoxOnClick(feature, checkbox) {
        if (checkbox.checked === true) {
            if (!selectedFeatures.includes(feature)) {
                selectedFeatures.push(feature);
            }
        } else {
            selectedFeatures.splice(selectedFeatures.indexOf(feature), 1);
        }
    }

    function checkBoxHigherStandardOnClick(checkbox) {
        if (checkbox.checked === true) {
            document.getElementById('price-per-day').innerHTML = 150;
        } else {
            document.getElementById('price-per-day').innerHTML = 100;
        }
    }

    function clearButtonBackgroundColor() {
        const buttons = document.querySelectorAll('.my-button');
        buttons.forEach(button => {
            button.style.backgroundColor = '#ededf0'
        });
    }

    function dateOnChange(el) {
        updateDate()
    }

    function rangeOnChange(el) {
        updateDate()
    }

    function updateDate() {
        const date = document.getElementById('id-date').value
        const days = document.getElementById('id-range').value
        document.getElementById('lbl-days').innerHTML = `(${days})`

        if (date === '') {
            return false;
        }

        const currentDate = new Date();
        const selectedDate = new Date(date);

        if (formatDate(selectedDate) < formatDate(currentDate)) {
            return false;
        }

        const newDate = new Date(date)

        newDate.setDate(newDate.getDate() + parseInt(days))
        document.getElementById('lbl-date-to').innerHTML = `${formatDate(newDate)} (${days} days)`
        return true
    }

    function areFieldsValid() {
        const date = document.getElementById('id-date').value
        const days = document.getElementById('id-range').value

        if (date === '') {
            return false
        }

        if (days === '') {
            return false
        }

        if (updateDate() === false) {
            return false
        }

        return true
    }

    function calculatePrice(days, pricePerDay, numberOfPeople, couponPrice, features) {
        let finalPrice = days * pricePerDay * numberOfPeople
        finalPrice -= finalPrice * couponPrice

        return finalPrice
    }

    function applyCoupon() {
        const couponValue = document.getElementById('coupon-input').value
        if (couponValue === 'GAD') {
            return 0.1
        }
        return 0
    }

    function calculate(el) {
        if (!areFieldsValid()) {
            const result = 'Please fill in all fields (date in future and number of days)'
            writeResults(result)
            return
        }

        let featuresStr = 'No features'
        if (features.length > 0) {
            featuresStr = features.join(', ')
        }
        updateDate()

        const date = document.getElementById('id-date').value
        const days = document.getElementById('id-range').value
        const pricePerDay = document.getElementById('price-per-day').innerHTML
        const numberOfPeople = document.querySelector('select').value

        const finalFullPrice = calculatePrice(days, pricePerDay, numberOfPeople, couponPrice, selectedFeatures)

        const finalDate = new Date(date)
        finalDate.setDate(finalDate.getDate() + parseInt(days))

        const result = `Reservation for ${date} - ${formatDate(finalDate)} for total price: ${finalFullPrice}$ with features: ${featuresStr}`
        writeResults(result)
    }

    function formatDate(date) {
        return `${date.toISOString().split('T')[0]}`
    }

    function roundToTwoPlaces(num) {
        return Math.round(num * 100) / 100
    }


    function openNav() {
        document.getElementById("options-side-panel").style.width = "200px";

        const overlayElement = document.getElementById('overlay')
        overlayElement.classList.add('active')
    }

    function closeNav() {
        document.getElementById("options-side-panel").style.width = "0";

        const overlayElement = document.getElementById('overlay')
        overlayElement.classList.remove('active')
    }

    function populateProjectsSidePanel() {
        const projectsSidePanel = document.getElementById("side-panel");
        projectsSidePanel.innerHTML = "";
        const divElement = document.createElement("div");
        divElement.id = "options-side-panel";
        divElement.classList.add("sidepanel");

        const openButtonElement = document.createElement("button");
        openButtonElement.classList.add("openbtn");
        openButtonElement.onclick = openNav;
        openButtonElement.innerHTML = `<i class="fa-solid fa-gear"></i>`;

        const closeElement = document.createElement("a");
        closeElement.href = "javascript:void(0)";
        closeElement.classList.add("closebtn");
        closeElement.onclick = closeNav;
        closeElement.innerHTML = `<i class="fa-regular fa-circle-xmark"></i>`;
        divElement.appendChild(closeElement);

        const labelElement = document.createElement("label");
        labelElement.textContent = "Coupon:";
        labelElement.classList.add("side-panel-label");
        const inputElement = document.createElement("input");
        inputElement.classList.add("side-panel-input");
        inputElement.type = "text";
        inputElement.id = "coupon-input";

        const applyButtonElement = document.createElement("button");
        applyButtonElement.textContent = "Apply";
        applyButtonElement.addEventListener("click", function () {
            couponPrice = applyCoupon();
        });
        applyButtonElement.classList.add("side-panel-button");

        const clearButtonElement = document.createElement("button");
        clearButtonElement.textContent = "Clear";
        clearButtonElement.addEventListener("click", function () {
            clearCoupon();
        });
        clearButtonElement.classList.add("side-panel-button");
        clearButtonElement.classList.add("side-panel-button-warn");

        divElement.appendChild(labelElement);
        divElement.appendChild(inputElement);
        divElement.appendChild(applyButtonElement);
        divElement.appendChild(clearButtonElement);

        projectsSidePanel.appendChild(divElement);
        projectsSidePanel.parentElement.appendChild(openButtonElement);
    }


    populateProjectsSidePanel();

</script>

</html>